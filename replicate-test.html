<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Replicate API Test - Selira AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }

        .form-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: 14px;
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .slider-group {
            display: flex;
            flex-direction: column;
        }

        input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }

        .slider-value {
            text-align: center;
            font-weight: 600;
            color: #667eea;
        }

        .model-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .model-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            font-size: 14px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: center;
        }

        .model-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .model-btn:active {
            transform: translateY(0);
        }

        .model-btn.active {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .result-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .result-section h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 18px;
            font-weight: 600;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-image {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .error {
            background: #fee;
            color: #c00;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .success {
            background: #efe;
            color: #060;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .info {
            background: #e3f2fd;
            color: #1565c0;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .model-info {
            background: #f5f5f5;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .model-info strong {
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¨ Replicate API Test</h1>

        <div class="info">
            <strong>Note:</strong> This is a test page for Replicate API integration. Make sure you have your API key configured in Netlify environment variables.
        </div>

        <div class="model-info">
            <strong>Selected Model:</strong> <span id="selectedModelName">None</span><br>
            <strong>Model ID:</strong> <span id="selectedModelId">Click a model button below</span>
        </div>

        <h3 style="margin-bottom: 15px; color: #333;">Select a Model:</h3>
        <div class="model-buttons">
            <button class="model-btn" data-model="7223ac95cada3c30951ad83ab63d09794c3f038ca69d5a644087510c07440e29">
                Flux Schnell Uncensored<br><small>Rasch3 (Fast)</small>
            </button>
            <button class="model-btn" data-model="b477d8fc3a62e591c6224e10020538c4a9c340fb1f494891aff60019ffd5bc48">
                Flux Dev Uncensored<br><small>MS NSFW v3</small>
            </button>
            <button class="model-btn" data-model="13f8afae9c06740b24e2d22a0fd7b4889c7381f72b49ce9cefc5fff34bdf51e2">
                Flux Dev Uncensored<br><small>Colossus v5</small>
            </button>
            <button class="model-btn" data-model="fb4f086702d6a301ca32c170d926239324a7b7b2f0afc3d232a9c4be382dc3fa">
                Flux Dev Uncensored<br><small>NSFW Flux Dev</small>
            </button>
            <button class="model-btn" data-model="d70438fcb9bb7adb8d6e59cf236f754be0b77625e984b8595d1af02cdf034b29">
                Reliberate v3<br><small>2M runs</small>
            </button>
            <button class="model-btn" data-model="627382d4ee73fee466de2a3e59ae99b831371610ae806193ebcfc7a3d295f7f3">
                Kaneko Gen<br><small>Unrestricted</small>
            </button>
            <button class="model-btn" data-model="47f609a66d7fc3293a600467fad383fffa9ef5193c9c871d4f7f9b514a0afe3f">
                Flux Dev Uncensored<br><small>Jibmix</small>
            </button>
            <button class="model-btn" data-model="9d7d06ebf0a2decf6caf0317ff6d61eb7078385126996a29a913c95b3ce0507f">
                Flux Dev Uncensored<br><small>Real Reveal 5</small>
            </button>
            <button class="model-btn" data-model="8cf067a09fbd627c5597781951e1a6988e3b69f6ef712b4948d3d2b5361569ad">
                Flux Dev Uncensored<br><small>New Reality A2</small>
            </button>
        </div>

        <h3 style="margin: 30px 0 15px; color: #333;">Poses:</h3>
        <div class="model-buttons" id="poseButtons">
            <button class="model-btn pose-btn" data-pose="standing pose, full body">Standing</button>
            <button class="model-btn pose-btn" data-pose="sitting pose, relaxed">Sitting</button>
            <button class="model-btn pose-btn" data-pose="lying down, comfortable pose">Lying Down</button>
            <button class="model-btn pose-btn" data-pose="leaning forward, confident pose">Leaning</button>
            <button class="model-btn pose-btn" data-pose="kneeling on knees, submissive pose, looking up, POV from above">Kneeling</button>
            <button class="model-btn pose-btn" data-pose="close-up portrait, face focus">Portrait</button>
            <button class="model-btn pose-btn" data-pose="POV blowjob, woman kneeling giving oral sex, huge erect penis in mouth, large dick visible, penis shaft in frame, cock clearly shown, male genitals visible, explicit blowjob, fellatio, sucking dick, oral penetration, POV from above, NSFW porn">ðŸ”¥ POV Blowjob</button>
            <button class="model-btn pose-btn" data-pose="doggy style sex, woman on all fours, ass up, large penis penetrating from behind, dick inside pussy, rear view, explicit penetration visible, cock entering, sexual intercourse, NSFW porn">ðŸ”¥ Doggy Style</button>
            <button class="model-btn pose-btn" data-pose="cowgirl sex position, woman riding on top, straddling, penis penetrating pussy, dick inside, explicit penetration, cock visible, sexual intercourse, breasts bouncing, NSFW porn">ðŸ”¥ Cowgirl</button>
            <button class="model-btn pose-btn" data-pose="missionary sex, woman on back, legs spread wide, large penis penetrating pussy, dick inside, explicit penetration visible, cock entering vagina, intimate angle, sexual intercourse, NSFW porn">ðŸ”¥ Missionary</button>
            <button class="model-btn pose-btn" data-pose="masturbating explicitly, hand between legs, fingers penetrating pussy, fingering herself, self-pleasure, legs spread wide open, touching genitals, rubbing clit, explicit masturbation, pleasuring herself, finger in vagina, NSFW porn">ðŸ”¥ Masturbating</button>
            <button class="model-btn pose-btn" data-pose="reverse cowgirl sex, woman riding facing away, ass view, straddling backwards, large penis penetrating from below, dick inside pussy, explicit penetration visible from behind, cock entering, sexual intercourse, NSFW porn">ðŸ”¥ Reverse Cowgirl</button>
            <button class="model-btn pose-btn" data-pose="legs spread wide open, sitting or lying, pussy exposed, vulva visible, spread eagle position, legs apart showing genitals, explicit spread, NSFW">ðŸ”¥ Legs Spread</button>
            <button class="model-btn pose-btn" data-pose="bent over pose, ass up, leaning forward over furniture, rear view, bent at waist, showing ass and pussy, explicit bent over position, NSFW">ðŸ”¥ Bent Over</button>
            <button class="model-btn pose-btn" data-pose="on knees submissive position, looking up at camera, POV angle from above, mouth open, tongue out, ready pose, kneeling down, NSFW">ðŸ”¥ On Knees POV</button>
            <button class="model-btn pose-btn" data-pose="titty fuck, large penis between breasts, huge dick sliding between tits, cock shaft visible, breasts squeezed around penis, explicit titfuck, paizuri, boob job, male genitals visible, NSFW porn">ðŸ”¥ Titty Fuck</button>
            <button class="model-btn pose-btn" data-pose="anal sex, large penis penetrating asshole, dick inside ass, anal penetration from behind, cock entering anus, spreading ass cheeks wide, asshole stretched, explicit anal intercourse, NSFW porn">ðŸ”¥ Anal</button>
        </div>

        <h3 style="margin: 30px 0 15px; color: #333;">Outfits:</h3>
        <div class="model-buttons" id="outfitButtons">
            <button class="model-btn outfit-btn" data-outfit="completely naked, fully nude, no clothes, bare skin, nude body, naked breasts, exposed pussy, totally naked, unclothed, full nudity, NSFW">ðŸ”¥ Fully Nude</button>
            <button class="model-btn outfit-btn" data-outfit="sexy lingerie, lace bra and panties, see-through lingerie, revealing intimate wear, skimpy underwear">Sexy Lingerie</button>
            <button class="model-btn outfit-btn" data-outfit="tiny bikini, skimpy swimwear, revealing bikini">Bikini</button>
            <button class="model-btn outfit-btn" data-outfit="topless, bare breasts, no bra, breasts exposed, nipples visible, naked from waist up, NSFW">ðŸ”¥ Topless</button>
            <button class="model-btn outfit-btn" data-outfit="wearing only stockings, thigh-high stockings, naked with stockings, stockings and nothing else, nude with stockings, NSFW">ðŸ”¥ Stockings Only</button>
            <button class="model-btn outfit-btn" data-outfit="fishnet bodysuit, fishnet lingerie, see-through fishnet outfit, fishnet stockings and top, mesh clothing, sexy fishnet, NSFW">ðŸ”¥ Fishnet</button>
            <button class="model-btn outfit-btn" data-outfit="tight latex outfit, shiny leather clothing, latex bodysuit, leather lingerie, kinky outfit, fetish wear, NSFW">ðŸ”¥ Latex/Leather</button>
            <button class="model-btn outfit-btn" data-outfit="sexy schoolgirl outfit, short skirt, unbuttoned shirt, revealing school uniform, naughty student look, anime schoolgirl, NSFW">ðŸ”¥ Schoolgirl</button>
            <button class="model-btn outfit-btn" data-outfit="sexy maid costume, french maid outfit, short skirt maid uniform, revealing maid dress, frilly maid outfit, NSFW">ðŸ”¥ Maid Outfit</button>
            <button class="model-btn outfit-btn" data-outfit="sexy nurse costume, revealing nurse outfit, short nurse dress, naughty nurse uniform, medical fetish outfit, NSFW">ðŸ”¥ Nurse</button>
            <button class="model-btn outfit-btn" data-outfit="garter belt and stockings, suspenders, garter straps, lingerie with garters, sexy garter set, thigh-high stockings with garters, NSFW">ðŸ”¥ Garter Belt</button>
            <button class="model-btn outfit-btn" data-outfit="wearing only panties, topless with panties, bare breasts with underwear, panties and nothing else, half naked, NSFW">ðŸ”¥ Panties Only</button>
            <button class="model-btn outfit-btn" data-outfit="sheer bodystocking, see-through body suit, mesh bodysuit, transparent full body stocking, revealing bodystocking, NSFW">ðŸ”¥ Bodystocking</button>
        </div>

        <h3 style="margin: 30px 0 15px; color: #333;">Companion Traits:</h3>
        <div class="form-section" style="margin-bottom: 20px;">
            <div class="form-group">
                <label for="ethnicity">Ethnicity</label>
                <select id="ethnicity">
                    <option value="">None</option>
                    <option value="white">White/Caucasian</option>
                    <option value="asian">Asian</option>
                    <option value="korean">Korean</option>
                    <option value="japanese">Japanese</option>
                    <option value="chinese">Chinese</option>
                    <option value="latina">Latina</option>
                    <option value="black">Black/African</option>
                    <option value="indian">Indian</option>
                    <option value="middle eastern">Middle Eastern</option>
                    <option value="mixed">Mixed Race</option>
                </select>
            </div>

            <div class="form-group">
                <label for="hairLength">Hair Length</label>
                <select id="hairLength">
                    <option value="">None</option>
                    <option value="short">Short</option>
                    <option value="medium">Medium</option>
                    <option value="long">Long</option>
                    <option value="very long">Very Long</option>
                </select>
            </div>

            <div class="form-group">
                <label for="hairColor">Hair Color</label>
                <select id="hairColor">
                    <option value="">None</option>
                    <option value="black">Black</option>
                    <option value="brown">Brown</option>
                    <option value="blonde">Blonde</option>
                    <option value="red">Red</option>
                    <option value="auburn">Auburn</option>
                    <option value="platinum blonde">Platinum Blonde</option>
                    <option value="pink">Pink</option>
                    <option value="blue">Blue</option>
                    <option value="purple">Purple</option>
                    <option value="green">Green</option>
                </select>
            </div>

            <div class="form-group">
                <label for="bodyType">Body Type</label>
                <select id="bodyType">
                    <option value="">None</option>
                    <option value="slim">Slim</option>
                    <option value="athletic">Athletic</option>
                    <option value="curvy">Curvy</option>
                    <option value="petite">Petite</option>
                    <option value="voluptuous">Voluptuous</option>
                    <option value="muscular">Muscular</option>
                    <option value="thick">Thick</option>
                    <option value="bbw">BBW</option>
                </select>
            </div>

            <div class="form-group">
                <label for="breastSize">Breast Size</label>
                <select id="breastSize">
                    <option value="">None</option>
                    <option value="small breasts">Small</option>
                    <option value="medium breasts">Medium</option>
                    <option value="large breasts">Large</option>
                    <option value="huge breasts">Huge</option>
                </select>
            </div>

            <div class="form-group">
                <label for="age">Age</label>
                <select id="age">
                    <option value="">None</option>
                    <option value="18 years old">18</option>
                    <option value="20 years old">20</option>
                    <option value="25 years old">25</option>
                    <option value="30 years old">30</option>
                    <option value="35 years old">35</option>
                    <option value="40 years old">40</option>
                </select>
            </div>
        </div>

        <form id="generateForm">
            <div class="form-section">
                <div class="form-group full-width">
                    <label for="prompt">Prompt *</label>
                    <textarea id="prompt" name="prompt" required placeholder="Describe the image you want to generate..."></textarea>
                </div>

                <div class="form-group">
                    <label for="width">Width</label>
                    <select id="width" name="width">
                        <option value="512" selected>512</option>
                        <option value="768">768</option>
                        <option value="1024">1024</option>
                        <option value="1280">1280</option>
                        <option value="1536">1536</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="height">Height</label>
                    <select id="height" name="height">
                        <option value="512" selected>512</option>
                        <option value="768">768</option>
                        <option value="1024">1024</option>
                        <option value="1280">1280</option>
                        <option value="1536">1536</option>
                    </select>
                </div>

                <div class="form-group slider-group">
                    <label for="num_inference_steps">Inference Steps: <span class="slider-value" id="stepsValue">28</span></label>
                    <input type="range" id="num_inference_steps" name="num_inference_steps" min="1" max="50" value="28">
                </div>

                <div class="form-group slider-group">
                    <label for="guidance_scale">Guidance Scale: <span class="slider-value" id="guidanceValue">7</span></label>
                    <input type="range" id="guidance_scale" name="guidance_scale" min="1" max="20" step="0.5" value="7">
                </div>

                <div class="form-group">
                    <label for="seed">Seed (optional, leave empty for random)</label>
                    <input type="number" id="seed" name="seed" placeholder="Random">
                </div>

                <div class="form-group">
                    <label for="output_format">Output Format</label>
                    <select id="output_format" name="output_format">
                        <option value="webp">WebP</option>
                        <option value="png">PNG</option>
                        <option value="jpg">JPG</option>
                    </select>
                </div>
            </div>

            <button type="submit" id="generateBtn">Generate Image</button>
        </form>

        <div class="result-section" id="resultSection" style="display: none;">
            <h2>Result</h2>
            <div id="resultContent"></div>
        </div>
    </div>

    <script>
        let selectedModel = null;
        let selectedPose = null;
        let selectedOutfit = null;

        // Model selection
        document.querySelectorAll('.model-btn:not(.pose-btn):not(.outfit-btn)').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.model-btn:not(.pose-btn):not(.outfit-btn)').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                selectedModel = this.getAttribute('data-model');
                document.getElementById('selectedModelName').textContent = this.textContent.trim();
                document.getElementById('selectedModelId').textContent = selectedModel;
            });
        });

        // Pose selection
        document.querySelectorAll('.pose-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.pose-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                selectedPose = this.getAttribute('data-pose');
                updatePrompt();
            });
        });

        // Outfit selection
        document.querySelectorAll('.outfit-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.outfit-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                selectedOutfit = this.getAttribute('data-outfit');
                updatePrompt();
            });
        });

        // Update prompt with selected pose and outfit
        function updatePrompt() {
            const promptField = document.getElementById('prompt');
            let promptParts = [];

            // Always add base description for woman
            promptParts.push('beautiful woman, female, solo');

            // Add companion traits
            const ethnicity = document.getElementById('ethnicity').value;
            const hairLength = document.getElementById('hairLength').value;
            const hairColor = document.getElementById('hairColor').value;
            const bodyType = document.getElementById('bodyType').value;
            const breastSize = document.getElementById('breastSize').value;
            const age = document.getElementById('age').value;

            if (ethnicity) promptParts.push(ethnicity + ' woman');
            if (age) promptParts.push(age);
            if (bodyType) promptParts.push(bodyType + ' body');
            if (breastSize) promptParts.push(breastSize);
            if (hairLength && hairColor) {
                promptParts.push(hairLength + ' ' + hairColor + ' hair');
            } else if (hairLength) {
                promptParts.push(hairLength + ' hair');
            } else if (hairColor) {
                promptParts.push(hairColor + ' hair');
            }

            if (selectedPose) promptParts.push(selectedPose);
            if (selectedOutfit) promptParts.push(selectedOutfit);

            // Add quality tags
            promptParts.push('high quality, detailed, 4k');

            if (promptParts.length > 0) {
                promptField.value = promptParts.join(', ');
            }
        }

        // Update prompt when traits change
        document.getElementById('ethnicity').addEventListener('change', updatePrompt);
        document.getElementById('hairLength').addEventListener('change', updatePrompt);
        document.getElementById('hairColor').addEventListener('change', updatePrompt);
        document.getElementById('bodyType').addEventListener('change', updatePrompt);
        document.getElementById('breastSize').addEventListener('change', updatePrompt);
        document.getElementById('age').addEventListener('change', updatePrompt);

        // Update slider values
        document.getElementById('num_inference_steps').addEventListener('input', (e) => {
            document.getElementById('stepsValue').textContent = e.target.value;
        });

        document.getElementById('guidance_scale').addEventListener('input', (e) => {
            document.getElementById('guidanceValue').textContent = e.target.value;
        });

        // Handle form submission
        document.getElementById('generateForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!selectedModel) {
                alert('Please select a model first!');
                return;
            }

            const generateBtn = document.getElementById('generateBtn');
            const resultSection = document.getElementById('resultSection');
            const resultContent = document.getElementById('resultContent');

            // Disable button and show loading
            generateBtn.disabled = true;
            generateBtn.textContent = 'Generating...';
            resultSection.style.display = 'block';
            resultContent.innerHTML = '<div class="loading"><div class="spinner"></div>Generating your image...</div>';

            // Collect form data
            const formData = {
                model: selectedModel,
                prompt: document.getElementById('prompt').value,
                width: parseInt(document.getElementById('width').value),
                height: parseInt(document.getElementById('height').value),
                num_inference_steps: parseInt(document.getElementById('num_inference_steps').value),
                guidance_scale: parseFloat(document.getElementById('guidance_scale').value),
                output_format: document.getElementById('output_format').value
            };

            // Add seed if provided
            const seedInput = document.getElementById('seed').value;
            if (seedInput) {
                formData.seed = parseInt(seedInput);
            }

            try {
                console.log('Sending request with data:', formData);

                const response = await fetch('/.netlify/functions/replicate-generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const data = await response.json();

                if (!response.ok) {
                    console.error('API Error Response:', data);
                    const errorMsg = data.details ? `${data.error}: ${data.details}` : (data.error || 'Failed to generate image');
                    throw new Error(errorMsg);
                }

                console.log('Response:', data);

                // Display success
                resultContent.innerHTML = `
                    <div class="success">
                        <strong>Success!</strong> Image generated successfully.
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <img src="${data.output}" alt="Generated image" class="result-image">
                    </div>
                `;

            } catch (error) {
                console.error('Error:', error);
                resultContent.innerHTML = `
                    <div class="error">
                        <strong>Error:</strong> ${error.message}
                    </div>
                `;
            } finally {
                // Re-enable button
                generateBtn.disabled = false;
                generateBtn.textContent = 'Generate Image';
            }
        });
    </script>
</body>
</html>
